---
title: "p8105_mtp_cy2522"
author: "Chu YU"
date: "2018-10-20"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

```

## import and clean the data
```{r}
mtp_tidy = read.csv("./data/p8105_mtp_data.csv") %>%
  janitor::clean_names() %>%
  gather(key = activity_number, value = activity, activity_1:activity_1440 ) %>%
  mutate(day = factor(day,levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday")))
```

## exploratory analyses
```{r}
## the structure of the data
str(mtp_tidy)

### explore the number of "1"
mtp_tidy %>%
  filter(activity == 1.00000) %>%
  group_by(week) %>% 
  summarise(n = n())
  

### outliers
mtp_tidy %>%
  mutate(week = factor(week)) %>%
  ggplot(aes(x = week, y = activity)) +
    geom_boxplot() +
    theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

## problem 2
###  explore the hypothesis that this participant became more active over time
```{r fig.height = 6, fig.width = 9}
##aggregate the data
mtp_total = mtp_tidy %>%
  group_by(week, day) %>%
  summarise(total_activity = sum(activity))

mtp_total %>%
  mutate(day_num = row_number(day) + (week - 1) * 7) %>%
  ggplot(aes( x = day_num, y = total_activity)) +
  geom_point() +
  geom_smooth(se = FALSE, color = "red") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs( 
    title = " plot of activity across the weeks ",
    x = "day",
    y = "activity of the day")
```
### examine the possibility that day of the week affects activity
```{r}
## the effect of the day in a week
mtp_total %>%
  ggplot(aes(x = factor(day), y = total_activity, fill = day)) +
  geom_boxplot() +
  labs( 
    title = " effect of each day ",
    x = "day",
    y = "activity ") 
```
  

```

